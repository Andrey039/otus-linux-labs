# Домашнее задание 15

разворачиваем сетевую лабораторию

# otus-linux
Vagrantfile - для стенда урока 9 - Network

# Дано
https://github.com/erlong15/otus-linux/tree/network
(ветка network)

Vagrantfile с начальным построением сети
- inetRouter
- centralRouter
- centralServer

тестировалось на virtualbox

# Планируемая архитектура
построить следующую архитектуру

Сеть office1
- 192.168.2.0/26 - dev
- 192.168.2.64/26 - test servers
- 192.168.2.128/26 - managers
- 192.168.2.192/26 - office hardware

Сеть office2
- 192.168.1.0/25 - dev
- 192.168.1.128/26 - test servers
- 192.168.1.192/26 - office hardware


Сеть central
- 192.168.0.0/28 - directors
- 192.168.0.32/28 - office hardware
- 192.168.0.64/26 - wifi

```
Office1 ---\
-----> Central --IRouter --> internet
Office2----/
```
Итого должны получится следующие сервера
- inetRouter
- centralRouter
- office1Router
- office2Router
- centralServer
- office1Server
- office2Server

# Теоретическая часть
- Найти свободные подсети
- Посчитать сколько узлов в каждой подсети, включая свободные
- Указать broadcast адрес для каждой подсети
- проверить нет ли ошибок при разбиении

# Практическая часть
- Соединить офисы в сеть согласно схеме и настроить роутинг
- Все сервера и роутеры должны ходить в инет черз inetRouter
- Все сервера должны видеть друг друга
- у всех новых серверов отключить дефолт на нат (eth0), который вагрант поднимает для связи
- при нехватке сетевых интервейсов добавить по несколько адресов на интерфейс


# Решение

# Теоретическая часть

Сеть office1<br><br>

192.168.2.0/26 - dev<br>
Адрес: 	192.168.2.0 	11000000.10101000.00000010.00000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.2.1 	11000000.10101000.00000010.00000001<br>
Максимальный IP: 	192.168.2.62 	11000000.10101000.00000010.00111110<br>
Broadcast: 	192.168.2.63 	11000000.10101000.00000010.00111111<br>
Число хостов:	62<br><br>

192.168.2.64/26 - test servers<br>
Адрес: 	192.168.2.64 	11000000.10101000.00000010.01000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.2.65 	11000000.10101000.00000010.01000001<br>
Максимальный IP: 	192.168.2.126 	11000000.10101000.00000010.01111110<br>
Broadcast: 	192.168.2.127 	11000000.10101000.00000010.01111111<br>
Число хостов:	62<br><br>

192.168.2.128/26 - managers<br>
Адрес: 	192.168.2.128 	11000000.10101000.00000010.10000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.2.129 	11000000.10101000.00000010.10000001<br>
Максимальный IP: 	192.168.2.190 	11000000.10101000.00000010.10111110<br>
Broadcast: 	192.168.2.191 	11000000.10101000.00000010.10111111<br>
Число хостов:	62<br><br>

192.168.2.192/26 - office hardware<br>
Адрес: 	192.168.2.192 	11000000.10101000.00000010.11000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.2.193 	11000000.10101000.00000010.11000001<br>
Максимальный IP: 	192.168.2.254 	11000000.10101000.00000010.11111110<br>
Broadcast: 	192.168.2.255 	11000000.10101000.00000010.11111111<br>
Число хостов:	62<br><br>

Сеть office2<br><br>

192.168.1.0/25 - dev<br>
Адрес: 	192.168.1.0 	11000000.10101000.00000001.00000000<br>
Сетевая маска: 	255.255.255.128 = 25 	11111111.11111111.11111111.10000000<br>
Минимальный IP: 	192.168.1.1 	11000000.10101000.00000001.00000001<br>
Максимальный IP: 	192.168.1.126 	11000000.10101000.00000001.01111110<br>
Broadcast: 	192.168.1.127 	11000000.10101000.00000001.01111111<br>
Число хостов:	126<br><br>

192.168.1.128/26 - test servers<br>
Адрес: 	192.168.1.128 	11000000.10101000.00000001.10000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.1.129 	11000000.10101000.00000001.10000001<br>
Максимальный IP: 	192.168.1.190 	11000000.10101000.00000001.10111110<br>
Broadcast: 	192.168.1.191 	11000000.10101000.00000001.10111111<br>
Число хостов:	62<br><br>

192.168.1.192/26 - office hardware<br>
Адрес: 	192.168.1.192 	11000000.10101000.00000001.11000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.1.193 	11000000.10101000.00000001.11000001<br>
Максимальный IP: 	192.168.1.254 	11000000.10101000.00000001.11111110<br>
Broadcast: 	192.168.1.255 	11000000.10101000.00000001.11111111<br>
Число хостов:	62<br><br>

Сеть central<br><br>

192.168.0.0/28 - directors<br>
Адрес: 	192.168.0.0 	11000000.10101000.00000000.00000000<br>
Сетевая маска: 	255.255.255.240 = 28 	11111111.11111111.11111111.11110000<br>
Минимальный IP: 	192.168.0.1 	11000000.10101000.00000000.00000001<br>
Максимальный IP: 	192.168.0.14 	11000000.10101000.00000000.00001110<br>
Broadcast: 	192.168.0.15 	11000000.10101000.00000000.00001111<br>
Число хостов:	14<br><br>

Свободная подсеть 192.168.0.16/28<br>
Адрес: 	192.168.0.16 	11000000.10101000.00000000.00010000<br>
Сетевая маска: 	255.255.255.240 = 28 	11111111.11111111.11111111.11110000<br>
Минимальный IP: 	192.168.0.17 	11000000.10101000.00000000.00010001<br>
Максимальный IP: 	192.168.0.30 	11000000.10101000.00000000.00011110<br>
Broadcast: 	192.168.0.31 	11000000.10101000.00000000.00011111<br>
Число хостов:	14<br><br>

192.168.0.32/28 - office hardware<br>
Адрес: 	192.168.0.32 	11000000.10101000.00000000.00100000<br>
Сетевая маска: 	255.255.255.240 = 28 	11111111.11111111.11111111.11110000<br>
Минимальный IP: 	192.168.0.33 	11000000.10101000.00000000.00100001<br>
Максимальный IP: 	192.168.0.46 	11000000.10101000.00000000.00101110<br>
Broadcast: 	192.168.0.47 	11000000.10101000.00000000.00101111<br>
Число хостов:	14<br><br>

Свободная подсеть 192.168.0.48/28<br>
Адрес: 	192.168.0.48 	11000000.10101000.00000000.00110000<br>
Сетевая маска: 	255.255.255.240 = 28 	11111111.11111111.11111111.11110000<br>
Минимальный IP: 	192.168.0.49 	11000000.10101000.00000000.00110001<br>
Максимальный IP: 	192.168.0.62 	11000000.10101000.00000000.00111110<br>
Broadcast: 	192.168.0.63 	11000000.10101000.00000000.00111111<br>
Число хостов:	14<br><br>
    
192.168.0.64/26 - wifi<br>
Адрес: 	192.168.0.64 	11000000.10101000.00000000.01000000<br>
Сетевая маска: 	255.255.255.192 = 26 	11111111.11111111.11111111.11000000<br>
Минимальный IP: 	192.168.0.65 	11000000.10101000.00000000.01000001<br>
Максимальный IP: 	192.168.0.126 	11000000.10101000.00000000.01111110<br>
Broadcast: 	192.168.0.127 	11000000.10101000.00000000.01111111<br>
Число хостов:	62<br><br>

Свободная подсеть 192.168.0.128/25<br>
Адрес: 	192.168.0.128 	11000000.10101000.00000000.10000000<br>
Сетевая маска: 	255.255.255.128 = 25 	11111111.11111111.11111111.10000000<br>
Минимальный IP: 	192.168.0.129 	11000000.10101000.00000000.10000001<br>
Максимальный IP: 	192.168.0.254 	11000000.10101000.00000000.11111110<br>
Broadcast: 	192.168.0.255 	11000000.10101000.00000000.11111111<br>
Число хостов:	126<br><br>

# Практическая часть

## Структура сети

```
office1Server ---\
  192.168.2.2
                 office1Router
                 192.168.2.1
                 192.168.2.65
                 192.168.2.129
                 192.168.2.193
                 192.68.0.34
                       \
centralServer -----> centralRouter   --   inetRouter        --> internet
  192.168.0.2         192.168.255.2      192.168.255.1
                      192.168.0.1
                      192.168.0.33
                      192.168.0.65
                       /
                office2Router 
                192.168.0.35      
                192.168.1.1
                192.168.1.129
                192.168.1.193                     
 office2Server----/
 192.168.1.2
```

Стенд разворачивается из [Vagrantfile](Vagrantfile) <br>
с помощью ролей ansible [inetRouter.yml](inetRouter.yml)<br>
[centralRouter.yml](centralRouter.yml)<br>
[centralServer.yml](centralServer.yml)<br>
[office1Router.yml](office1Router.yml)<br>
[office1Server.yml](office1Server.yml)<br>
[office2Router.yml](office2Router.yml)<br>
[office2Server.yml](office2Server.yml)
